"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[4053],{54053:function(e,t,n){n.r(t);var s=n(74165),i=n(1413),a=n(15861),r=n(70885),o=n(72791),c=n(9140),u=n(95313),l=n(43360),d=n(55705),m=n(81724),h=n(85239),p=n(9085),b=n(57689),j=n(85983),g=n(80184);t.default=function(){var e=(0,b.UO)(),t=(0,o.useRef)(null),n=(0,b.s0)(),f=(0,o.useState)([]),Z=(0,r.Z)(f,2),v=Z[0],x=Z[1],y=(0,o.useState)([]),_=(0,r.Z)(y,2),C=_[0],k=_[1],w=(0,o.useState)([]),S=(0,r.Z)(w,2),B=S[0],I=S[1],q=(0,o.useState)([]),N=(0,r.Z)(q,2),L=N[0],E=N[1],P=(0,o.useState)({year:"",subject:"",module:"",topic:"",name:"",content:"",permission:0}),F=(0,r.Z)(P,2),G=F[0],A=F[1],z=m.Ry({year:m.Z_("Choose a year.").required("Year is required."),subject:m.Z_("Choose a subject.").required("Subject is required"),module:m.Z_("Choose a module.").required("Module is required."),topic:m.Z_("Choose a topic.").required("Topic is required."),name:m.Z_("Enter a sub topic name.").test("len","Must be less than or equal to 64 characters.",(function(e){return e||(e=""),e.length<=64})).required("Please enter a name.")});(0,o.useEffect)((function(){(0,a.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.Z.get("/admin/years/get-all-populate");case 2:t=e.sent,n=t.data,x(n),k(n.length?n[0].subjects:[]),I(n.length&&n[0].subjects.length?n[0].subjects[0].modules:[]),E(n.length&&n[0].subjects.length&&n[0].subjects[0].modules.length?n[0].subjects[0].modules[0].topics:[]),A((0,i.Z)((0,i.Z)({},G),{},{year:n.length?n[0]._id:"",subject:n.length&&n[0].subjects.length?n[0].subjects[0]._id:"",module:n.length&&n[0].subjects.length&&n[0].subjects[0].modules.length?n[0].subjects[0].modules[0]._id:"",topic:n.length&&n[0].subjects.length&&n[0].subjects[0].modules.length&&n[0].subjects[0].modules[0].topics.length?n[0].subjects[0].modules[0].topics[0]._id:""}));case 9:case"end":return e.stop()}}),e)})))()}),[]),(0,o.useEffect)((function(){(0,a.Z)((0,s.Z)().mark((function t(){var n,a,r;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.id,t.next=3,h.Z.get("/admin/sub-topics/".concat(n));case 3:a=t.sent,(r=a.data).success?A((0,i.Z)((0,i.Z)({},G),{},{year:r.data.topic.module.subject.year._id,subject:r.data.topic.module.subject._id,module:r.data.topic.module._id,topic:r.data.topic._id,name:r.data.name,content:r.data.content,permission:r.data.permission})):p.Am.error(r.msg);case 6:case"end":return t.stop()}}),t)})))()}),[]);var D=function(e){var t=v.findIndex((function(t){return t._id===e.target.value}));k(v[t].subjects),I(v[t].subjects.length?v[t].subjects[0].modules:[]),E(v[t].subjects.length&&v[t].subjects[0].modules.length?v[t].subjects[0].modules[0].topics:[]),A((0,i.Z)((0,i.Z)({},G),{},{year:e.target.value,subject:v[t].subjects.length?v[t].subjects[0]._id:"",module:v[t].subjects.length&&v[t].subjects[0].modules.length?v[t].subjects[0].modules[0]._id:"",topic:v[t].subjects.length&&v[t].subjects[0].topics.length?v[t].subjects[0].topics[0]._id:""}))},M=function(e){var t=C.findIndex((function(t){return t._id===e.target.value}));I(C[t].modules),E(C[t].modules.length?C[t].modules[0].topics:[]),A((0,i.Z)((0,i.Z)({},G),{},{subject:e.target.value,module:C[t].modules.length?C[t].modules[0]._id:"",topic:C[t].modules.length&&C[t].modules[0].topics.length?C[t].modules[0].topics[0]._id:""}))},O=function(e){var t=B.findIndex((function(t){return t._id===e.target.value}));E(B[t].topics),A((0,i.Z)((0,i.Z)({},G),{},{module:e.target.value,topic:B[t].topics.length?B[t].topics[0]._id:""}))},R=function(e){A((0,i.Z)((0,i.Z)({},G),{},{topic:e.target.value}))},T=function(e){A((0,i.Z)((0,i.Z)({},G),{},{permission:Number(e.target.value)}))},V=function(){var i=(0,a.Z)((0,s.Z)().mark((function i(a,r){var o,c,u,l;return(0,s.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return o=r.resetForm,c=e.id,a.content=t.current.getContent(),s.next=5,h.Z.put("admin/sub-topics/".concat(c),a);case 5:u=s.sent,(l=u.data).success?(p.Am.success(l.msg),o(),n("/admin/sub-topics")):p.Am.error(l.msg);case 8:case"end":return s.stop()}}),i)})));return function(e,t){return i.apply(this,arguments)}}();return(0,g.jsxs)(c.Z,{children:[(0,g.jsx)(c.Z.Header,{style:{background:"#3c4b64"},bsPrefix:"card-header py-3",children:(0,g.jsx)(c.Z.Title,{bsPrefix:"card-title mb-0 text-light",as:"h5",children:"Edit subtopic"})}),(0,g.jsx)(c.Z.Body,{children:(0,g.jsx)(d.J9,{validationSchema:z,validateOnChange:!1,validateOnBlur:!1,onSubmit:V,initialValues:G,enableReinitialize:!0,children:function(e){var n=e.handleSubmit,s=e.handleChange,i=e.handleBlur,a=e.values,r=e.touched,o=e.errors;return(0,g.jsxs)(u.Z,{noValidate:!0,onSubmit:n,children:[(0,g.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,g.jsx)(u.Z.Label,{children:"Year:"}),(0,g.jsx)(u.Z.Select,{name:"year",value:a.year,onChange:D,onBlur:i,touched:r,isInvalid:!!o.year,children:v.map((function(e,t){return(0,g.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,g.jsx)(u.Z.Control.Feedback,{type:"invalid",children:o.year})]}),(0,g.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,g.jsx)(u.Z.Label,{children:"Subject:"}),(0,g.jsx)(u.Z.Select,{name:"subject",value:a.subject,onChange:M,onBlur:i,touched:r,isInvalid:!!o.subject,children:C.map((function(e,t){return(0,g.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,g.jsx)(u.Z.Control.Feedback,{type:"invalid",children:o.subject})]}),(0,g.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,g.jsx)(u.Z.Label,{children:"Module:"}),(0,g.jsx)(u.Z.Select,{name:"module",value:a.module,onChange:O,onBlur:i,touched:r,isInvalid:!!o.module,children:B.map((function(e,t){return(0,g.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,g.jsx)(u.Z.Control.Feedback,{type:"invalid",children:o.module})]}),(0,g.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,g.jsx)(u.Z.Label,{children:"Topic:"}),(0,g.jsx)(u.Z.Select,{name:"topic",value:G.topic,onChange:R,onBlur:i,touched:r,isInvalid:!!o.topic,children:L.map((function(e,t){return(0,g.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,g.jsx)(u.Z.Control.Feedback,{type:"invalid",children:o.topic})]}),(0,g.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,g.jsx)(u.Z.Label,{children:"Name:"}),(0,g.jsx)(u.Z.Control,{type:"text",placeholder:"Please enter a sub topic name.",name:"name",onChange:s,onBlur:i,value:a.name,touched:r,isInvalid:!!o.name}),(0,g.jsx)(u.Z.Control.Feedback,{type:"invalid",children:o.name})]}),(0,g.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,g.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Open",id:"permission-1",value:"0",checked:0===a.permission,onChange:T,onBlur:i}),(0,g.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Free",id:"permission-2",value:"1",checked:1===a.permission,onChange:T,onBlur:i}),(0,g.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Premium",id:"permission-3",value:"2",checked:2===a.permission,onChange:T,onBlur:i})]}),(0,g.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,g.jsx)(u.Z.Label,{children:"Description:"}),(0,g.jsx)(j.M,{tinymceScriptSrc:"/tinymce/tinymce.min.js",onInit:function(e,n){return t.current=n},init:{height:450,menubar:!0,plugins:["image","grid","tiny_mce_wiris","code","table","link","media","codesample"],toolbar:"undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | grid_insert | tiny_mce_wiris_formulaEditor tiny_mce_wiris_formulaEditorChemistry | help",draggable_modal:!0,init_instance_callback:function(e){e.contentWindow.addEventListener("copy",(function(e){e.preventDefault()})),e.contentWindow.addEventListener("paste",(function(e){e.preventDefault()})),e.contentWindow.addEventListener("keydown",(function(e){!e.ctrlKey&&!e.metaKey||"p"!==e.key&&16!==e.charCode&&112!==e.charCode&&80!==e.keyCode||(e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))},content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"},name:"content",initialValue:a.content})]}),(0,g.jsxs)(l.Z,{type:"submit",variant:"primary",className:"float-end",children:[(0,g.jsx)("i",{className:"fa fa-save"})," Save"]})]})}})})]})}},85239:function(e,t,n){var s=n(61044),i=function(){return window.localStorage.getItem("token")?localStorage.getItem("token"):null},a=s.ZP.create({baseURL:"/api/v1/",timeout:15e3,headers:{Authorization:"Bearer ".concat(i())}});a.interceptors.request.use((function(e){return e.headers.Authorization="Bearer ".concat(i()),e})),a.interceptors.response.use((function(e){return e}),(function(e){return 401!==e.response.status&&403!==e.response.status&&406!==e.response.status||(window.localStorage.clear(),window.location.href="/login"),Promise.reject(e)})),t.Z=a}}]);
//# sourceMappingURL=4053.5c04d107.chunk.js.map