{"version":3,"file":"static/js/4210.a115c0ce.chunk.js","mappings":"mOAkEA,UAzD2B,WACvB,IAAQA,GAAUC,EAAAA,EAAAA,MAAVD,MACFE,GAAWC,EAAAA,EAAAA,MACXC,GAAWC,EAAAA,EAAAA,MACjB,GAAoDC,EAAAA,EAAAA,KAAY,SAAAC,GAAK,OAAIA,EAAMC,IAAI,IAA3EC,EAAW,EAAXA,YAAaC,EAAiB,EAAjBA,kBAAmBC,EAAO,EAAPA,SAExCC,EAAAA,EAAAA,YAAU,WACNC,SAASC,MAAQ,8BACjB,IAAMC,EAAkB,IAAIC,gBAE5B,OADAC,EAAsBF,EAAgBG,QAC/B,kBAAMH,EAAgBI,OAAQ,CACzC,GAAG,IAEH,IAAMF,EAAqB,yCAAG,WAAOC,GAAM,8EACZ,OAA3BhB,GAASkB,EAAAA,EAAAA,KAAW,IAAO,SACNC,EAAAA,EAAAA,IAAS,gBAAD,OAAiBrB,GAAS,CAAEkB,OAAAA,IAAU,KAAD,EAChC,GADgC,SAA5DI,EAAI,EAAJA,KACNC,QAAQC,IAAI,gBAAiBF,IACzBA,EAAKG,OAAO,CAAD,gBAEW,OADxBvB,GAASkB,EAAAA,EAAAA,KAAW,IACpBM,EAAAA,GAAAA,QAAcJ,EAAKK,KAAK,UAClBzB,GAAS0B,EAAAA,EAAAA,IAAW,CACtBpB,KAAMc,EAAKd,KACXR,MAAOsB,EAAKtB,SACZ,KAAD,GAEH6B,IAAoB,wBAElBH,EAAAA,GAAAA,MAAYJ,EAAKK,KACjBvB,EAAS,UAAS,4CAEzB,gBAjB0B,sCAkBrByB,EAAiB,yCAAG,2FACM,OAA9BN,QAAQC,IAAI,KAAMf,GAAY,SACTY,EAAAA,EAAAA,KAAU,WAAD,OAAYZ,EAAYqB,SAAW,CAC/DtB,KAAMC,EACNsB,WAAYrB,IACX,KAAD,YAHIY,EAAI,EAAJA,MAIGU,SACP9B,GAASkB,EAAAA,EAAAA,KAAW,IACpBa,OAAOC,aAAaC,WAAW,cAC/BF,OAAOG,SAASC,KAAOf,EAAKgB,eAE5BpC,GAASkB,EAAAA,EAAAA,KAAW,IACpBM,EAAAA,GAAAA,MAAYJ,EAAKK,MAClB,2CACF,kBAdsB,mCAevB,OACI,gBAAKY,UAAU,kEAAiE,UAC5E,UAAC,IAAS,CAACA,UAAU,cAAa,UAC/BhB,QAAQC,IAAId,EAAmBD,GAC/BE,IACC,iBAAM4B,UAAU,sBAAqB,0DAIrD,C,uCC/DMC,EAAW,WACb,OAAOP,OAAOC,aAAaO,QAAQ,SAAWP,aAAaO,QAAQ,SAAW,IAClF,EAEMC,EAAOC,EAAAA,GAAAA,OAAa,CAEtBC,QAAS,WACTC,QAAS,KACTC,QAAS,CACLC,cAAc,UAAD,OAAYP,QAIjCE,EAAKM,aAAaC,QAAQC,KAAI,SAASC,GAEnC,OADAA,EAAOL,QAAQC,cAAa,iBAAaP,KAClCW,CACX,IACAT,EAAKM,aAAaI,SAASF,KAAI,SAASE,GACpC,OAAOA,CACX,IAAG,SAASC,GAKR,OAJ4B,MAAxBA,EAAID,SAAS3B,QAA0C,MAAxB4B,EAAID,SAAS3B,QAA0C,MAAxB4B,EAAID,SAAS3B,SAC3EQ,OAAOC,aAAaoB,QACpBrB,OAAOG,SAASC,KAAO,UAEpBkB,QAAQC,OAAOH,EAC1B,IAEA,K","sources":["pages/users/PremiumVerifyEmail.jsx","services/Http.js"],"sourcesContent":["import { useEffect } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { createUser } from \"../../store/reducers/userReducer\";\r\nimport { setLoading } from \"../../store/reducers/userReducer\";\r\nimport { Container } from \"react-bootstrap\";\r\nimport { toast } from \"react-toastify\";\r\nimport Http from \"../../services/Http\";\r\n\r\nconst PremiumVerifyEmail = () => {\r\n    const { token } = useParams();\r\n    const dispatch = useDispatch();\r\n    const navigate = useNavigate();\r\n    const { premiumUser, premiumMembership, loading } = useSelector(state => state.user);\r\n\r\n    useEffect(() => {\r\n        document.title = \"AnswerSheet - HSC made easy\"\r\n        const abortController = new AbortController();\r\n        setPremiumVerifyEmail(abortController.signal);\r\n        return () => abortController.abort();\r\n    }, []);\r\n\r\n    const setPremiumVerifyEmail = async (signal) => {\r\n        dispatch(setLoading(true));\r\n        let { data } = await Http.get(`verify-email/${token}`, { signal });\r\n        console.log(\"DATA========>\", data)\r\n        if (data.status) {\r\n          dispatch(setLoading(false));\r\n          toast.success(data.msg);\r\n          await dispatch(createUser({\r\n              user: data.user,\r\n              token: data.token\r\n          }));\r\n            // navigate(\"/subjects\");\r\n          upgradeMembership();\r\n        } else {\r\n            toast.error(data.msg);\r\n            navigate(\"/login\")\r\n        }\r\n    }\r\n    const upgradeMembership = async () => {\r\n      console.log(\"OK\", premiumUser)\r\n      let { data } = await Http.post(`billing/${premiumUser.gateway}`, {\r\n        user: premiumUser,\r\n        membership: premiumMembership\r\n      });\r\n      if (data.success) {\r\n        dispatch(setLoading(false));\r\n        window.localStorage.removeItem('membership')\r\n        window.location.href = data.redirect_url\r\n      } else {\r\n        dispatch(setLoading(false))\r\n        toast.error(data.msg)\r\n      }\r\n    }\r\n    return (\r\n        <div className=\"page-container d-flex align-items-center justify-content-center\">\r\n            <Container className=\"text-center\">\r\n              {console.log(premiumMembership, premiumUser)}\r\n              {loading && \r\n                <span className=\"alert alert-success\">Please wait while verifing your email...</span>}\r\n            </Container>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default PremiumVerifyEmail;","import axios from \"axios\";\r\nconst getToken = () => {\r\n    return window.localStorage.getItem(\"token\") ? localStorage.getItem(\"token\") : null;\r\n}\r\n\r\nconst http = axios.create({\r\n    // baseURL: \"http://localhost:5000/api/v1/\",\r\n    baseURL: \"/api/v1/\",\r\n    timeout: 15000,\r\n    headers: {\r\n        Authorization: `Bearer ${getToken()}`\r\n    }\r\n});\r\n\r\nhttp.interceptors.request.use(function(config) {\r\n    config.headers.Authorization = `Bearer ${getToken()}`;\r\n    return config;\r\n});\r\nhttp.interceptors.response.use(function(response) {\r\n    return response;\r\n}, function(err) {\r\n    if (err.response.status === 401 || err.response.status === 403 || err.response.status === 406) {\r\n        window.localStorage.clear();\r\n        window.location.href = \"/login\";\r\n    } \r\n    return Promise.reject(err);\r\n});\r\n\r\nexport default http;"],"names":["token","useParams","dispatch","useDispatch","navigate","useNavigate","useSelector","state","user","premiumUser","premiumMembership","loading","useEffect","document","title","abortController","AbortController","setPremiumVerifyEmail","signal","abort","setLoading","Http","data","console","log","status","toast","msg","createUser","upgradeMembership","gateway","membership","success","window","localStorage","removeItem","location","href","redirect_url","className","getToken","getItem","http","axios","baseURL","timeout","headers","Authorization","interceptors","request","use","config","response","err","clear","Promise","reject"],"sourceRoot":""}