"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3679],{3679:function(e,n,t){t.r(n);var i=t(74165),r=t(1413),s=t(15861),a=t(70885),c=t(72791),o=t(9140),u=t(95313),l=t(43360),d=t(55705),p=t(81724),m=t(85239),h=t(9085),b=t(57689),f=t(85983),j=t(80184);n.default=function(){var e=(0,c.useRef)(null),n=(0,b.s0)(),t=(0,c.useState)([]),g=(0,a.Z)(t,2),Z=g[0],v=g[1],x=(0,c.useState)([]),y=(0,a.Z)(x,2),_=y[0],C=y[1],k=(0,c.useState)([]),w=(0,a.Z)(k,2),S=w[0],B=w[1],N=(0,c.useState)({year:"",subject:"",topic:"",name:"",content:"",permission:2}),I=(0,a.Z)(N,2),q=I[0],L=I[1],E=p.Ry({year:p.Z_("Choose a year.").required("Year is required."),subject:p.Z_("Choose a subject.").required("Subject is required"),topic:p.Z_("Choose a topic.").required("Topic is required."),name:p.Z_("Enter a sub topic name.").test("len","Must be less than 64 characters.",(function(e){return e.length<64})).required("Sub topic name is required.")});(0,c.useEffect)((function(){}),[]),(0,c.useEffect)((function(){var e=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){var n,t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.Z.get("/admin/years/get-all-populate");case 2:n=e.sent,t=n.data,v(t),C(t.length?t[0].subjects:[]),B(t.length&&t[0].subjects.length?t[0].subjects[0].topics:[]),L((0,r.Z)((0,r.Z)({},q),{},{year:t.length?t[0]._id:"",subject:t.length&&t[0].subjects.length?t[0].subjects[0]._id:"",topic:t.length&&t[0].subjects.length&&t[0].subjects[0].topics.length?t[0].subjects[0].topics[0]._id:""}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var P=function(e){var n=Z.findIndex((function(n){return n._id===e.target.value}));C(Z[n].subjects),B(Z[n].subjects.length?Z[n].subjects[0].topics:[]),L((0,r.Z)((0,r.Z)({},q),{},{year:e.target.value,subject:Z[n].subjects.length?Z[n].subjects[0]._id:"",topic:Z[n].subjects.length&&Z[n].subjects[0].topics.length?Z[n].subjects[0].topics[0]._id:""}))},F=function(e){var n=_.findIndex((function(n){return n._id===e.target.value}));B(_[n].topics),L((0,r.Z)((0,r.Z)({},q),{},{subject:e.target.value,topic:_[n].topics.length?_[n].topics[0]._id:""}))},G=function(e){L((0,r.Z)((0,r.Z)({},q),{},{topic:e.target.value}))},A=function(e){L((0,r.Z)((0,r.Z)({},q),{},{permission:Number(e.target.value)}))},z=function(){var t=(0,s.Z)((0,i.Z)().mark((function t(r,s){var a,c,o;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=s.resetForm,r.content=e.current.getContent(),t.next=4,m.Z.post("admin/sub-topics",r);case 4:c=t.sent,(o=c.data).success?(h.Am.success(o.msg),a(),n("/admin/sub-topics")):h.Am.error(o.msg);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return(0,j.jsxs)(o.Z,{children:[(0,j.jsx)(o.Z.Header,{style:{background:"#3c4b64"},bsPrefix:"card-header py-3",children:(0,j.jsx)(o.Z.Title,{bsPrefix:"card-title mb-0 text-light",as:"h5",children:"New subtopic"})}),(0,j.jsx)(o.Z.Body,{children:(0,j.jsx)(d.J9,{validationSchema:E,validateOnChange:!1,validateOnBlur:!1,onSubmit:z,initialValues:q,enableReinitialize:!0,children:function(n){var t=n.handleSubmit,i=n.handleChange,r=n.handleBlur,s=n.values,a=n.touched,c=n.errors;return(0,j.jsxs)(u.Z,{noValidate:!0,onSubmit:t,children:[(0,j.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,j.jsx)(u.Z.Label,{children:"Year:"}),(0,j.jsx)(u.Z.Select,{name:"year",value:q.year,onChange:P,onBlur:r,touched:a,isInvalid:!!c.year,children:Z.map((function(e,n){return(0,j.jsx)("option",{value:e._id,children:e.name},n)}))}),(0,j.jsx)(u.Z.Control.Feedback,{type:"invalid",children:c.year})]}),(0,j.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,j.jsx)(u.Z.Label,{children:"Subject:"}),(0,j.jsx)(u.Z.Select,{name:"subject",value:q.subject,onChange:F,onBlur:r,touched:a,isInvalid:!!c.subject,children:_.map((function(e,n){return(0,j.jsx)("option",{value:e._id,children:e.name},n)}))}),(0,j.jsx)(u.Z.Control.Feedback,{type:"invalid",children:c.subject})]}),(0,j.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,j.jsx)(u.Z.Label,{children:"Topic:"}),(0,j.jsx)(u.Z.Select,{name:"topic",value:q.topic,onChange:G,onBlur:r,touched:a,isInvalid:!!c.topic,children:S.map((function(e,n){return(0,j.jsx)("option",{value:e._id,children:e.name},n)}))}),(0,j.jsx)(u.Z.Control.Feedback,{type:"invalid",children:c.topic})]}),(0,j.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,j.jsx)(u.Z.Label,{children:"Name:"}),(0,j.jsx)(u.Z.Control,{type:"text",placeholder:"Please enter a sub topic name.",name:"name",onChange:i,onBlur:r,value:s.name,touched:a,isInvalid:!!c.name}),(0,j.jsx)(u.Z.Control.Feedback,{type:"invalid",children:c.name})]}),(0,j.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,j.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Open",id:"permission-1",value:"0",checked:0===s.permission,onChange:A,onBlur:r}),(0,j.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Free",id:"permission-2",value:"1",checked:1===s.permission,onChange:A,onBlur:r}),(0,j.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Premium",id:"permission-3",value:"2",checked:2===s.permission,onChange:A,onBlur:r})]}),(0,j.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,j.jsx)(u.Z.Label,{children:"Description:"}),(0,j.jsx)(f.M,{tinymceScriptSrc:"/tinymce/tinymce.min.js",onInit:function(n,t){return e.current=t},init:{height:450,menubar:!0,plugins:["image","grid","tiny_mce_wiris","code","table","link","media","codesample"],toolbar:"undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | grid_insert | tiny_mce_wiris_formulaEditor tiny_mce_wiris_formulaEditorChemistry | help",draggable_modal:!0,init_instance_callback:function(e){e.contentWindow.addEventListener("copy",(function(e){e.preventDefault()})),e.contentWindow.addEventListener("paste",(function(e){e.preventDefault()})),e.contentWindow.addEventListener("keydown",(function(e){!e.ctrlKey&&!e.metaKey||"p"!==e.key&&16!==e.charCode&&112!==e.charCode&&80!==e.keyCode||(e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))},content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"},name:"description"})]}),(0,j.jsxs)(l.Z,{type:"submit",variant:"primary",className:"float-end",children:[(0,j.jsx)("i",{className:"fa fa-save"})," Save"]})]})}})})]})}},85239:function(e,n,t){var i=t(61044),r=function(){return window.localStorage.getItem("token")?localStorage.getItem("token"):null},s=i.ZP.create({baseURL:"/api/v1/",timeout:15e3,headers:{Authorization:"Bearer ".concat(r())}});s.interceptors.request.use((function(e){return e.headers.Authorization="Bearer ".concat(r()),e})),s.interceptors.response.use((function(e){return e}),(function(e){return 401!==e.response.status&&403!==e.response.status&&406!==e.response.status||(window.localStorage.clear(),window.location.href="/login"),Promise.reject(e)})),n.Z=s}}]);
//# sourceMappingURL=3679.9fe64321.chunk.js.map