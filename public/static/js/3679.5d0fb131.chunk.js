"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3679],{3679:function(e,t,n){n.r(t);var s=n(74165),i=n(1413),r=n(15861),a=n(70885),l=n(72791),o=n(9140),u=n(95313),c=n(43360),d=n(55705),m=n(81724),h=n(85239),p=n(9085),b=n(57689),j=n(85983),g=n(80184);t.default=function(){var e=(0,l.useRef)(null),t=(0,b.s0)(),n=(0,l.useState)([]),Z=(0,a.Z)(n,2),f=Z[0],v=Z[1],x=(0,l.useState)([]),y=(0,a.Z)(x,2),_=y[0],C=y[1],k=(0,l.useState)([]),S=(0,a.Z)(k,2),w=S[0],B=S[1],N=(0,l.useState)([]),I=(0,a.Z)(N,2),q=I[0],F=I[1],G=(0,l.useState)({year:"",subject:"",module:"",topic:"",name:"",content:"",permission:2}),L=(0,a.Z)(G,2),P=L[0],A=L[1],z=m.Ry({year:m.Z_("Choose a year.").required("Year is required."),subject:m.Z_("Choose a subject.").required("Subject is required"),module:m.Z_("Choose a module.").required("Module is required."),topic:m.Z_("Choose a topic.").required("Topic is required."),name:m.Z_("Enter a sub topic name.").test("len","Must be less than 64 characters.",(function(e){return e||(e=""),e.length<64})).required("Please enter a name.")});(0,l.useEffect)((function(){(0,r.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.Z.get("/admin/years/get-all-populate");case 2:t=e.sent,n=t.data,v(n),C(n.length?n[0].subjects:[]),B(n.length&&n[0].subjects.length?n[0].subjects[0].modules:[]),F(n.length&&n[0].subjects.length&&n[0].subjects[0].modules.length?n[0].subjects[0].modules[0].topics:[]),A((0,i.Z)((0,i.Z)({},P),{},{year:n.length?n[0]._id:"",subject:n.length&&n[0].subjects.length?n[0].subjects[0]._id:"",module:n.length&&n[0].subjects.length&&n[0].subjects[0].modules.length?n[0].subjects[0].modules[0]._id:"",topic:n.length&&n[0].subjects.length&&n[0].subjects[0].modules.length&&n[0].subjects[0].modules[0].topics.length?n[0].subjects[0].modules[0].topics[0]._id:""}));case 9:case"end":return e.stop()}}),e)})))()}),[]);var E=function(e){var t=f.findIndex((function(t){return t._id===e.target.value}));C(f[t].subjects),B(f[t].subjects.length?f[t].subjects[0].modules:[]),F(f[t].subjects.length&&f[t].subjects[0].modules.length?f[t].subjects[0].modules[0].topics:[]),A((0,i.Z)((0,i.Z)({},P),{},{year:e.target.value,subject:f[t].subjects.length?f[t].subjects[0]._id:"",module:f[t].subjects.length&&f[t].subjects[0].modules.length?f[t].subjects[0].modules[0]._id:"",topic:f[t].subjects.length&&f[t].subjects[0].topics.length?f[t].subjects[0].topics[0]._id:""}))},M=function(e){var t=_.findIndex((function(t){return t._id===e.target.value}));B(_[t].modules),F(_[t].modules.length?_[t].modules[0].topics:[]),A((0,i.Z)((0,i.Z)({},P),{},{subject:e.target.value,module:_[t].modules.length?_[t].modules[0]._id:"",topic:_[t].modules.length&&_[t].modules[0].topics.length?_[t].modules[0].topics[0]._id:""}))},R=function(e){var t=w.findIndex((function(t){return t._id===e.target.value}));F(w[t].topics),A((0,i.Z)((0,i.Z)({},P),{},{module:e.target.value,topic:w[t].topics.length?w[t].topics[0]._id:""}))},O=function(e){A((0,i.Z)((0,i.Z)({},P),{},{topic:e.target.value}))},T=function(e){A((0,i.Z)((0,i.Z)({},P),{},{permission:Number(e.target.value)}))},H=function(){var n=(0,r.Z)((0,s.Z)().mark((function n(i,r){var a,l,o;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=r.resetForm,i.content=e.current.getContent(),n.next=4,h.Z.post("admin/sub-topics",i);case 4:l=n.sent,(o=l.data).success?(p.Am.success(o.msg),a(),t("/admin/sub-topics")):p.Am.error(o.msg);case 7:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();return(0,g.jsxs)(o.Z,{children:[(0,g.jsx)(o.Z.Header,{style:{background:"#3c4b64"},bsPrefix:"card-header py-3",children:(0,g.jsx)(o.Z.Title,{bsPrefix:"card-title mb-0 text-light",as:"h5",children:"New subtopic"})}),(0,g.jsx)(o.Z.Body,{children:(0,g.jsx)(d.J9,{validationSchema:z,validateOnChange:!1,validateOnBlur:!1,onSubmit:H,initialValues:P,enableReinitialize:!0,children:function(t){var n=t.handleSubmit,s=t.handleChange,i=t.handleBlur,r=t.values,a=t.touched,l=t.errors;return(0,g.jsxs)(u.Z,{noValidate:!0,onSubmit:n,children:[(0,g.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,g.jsx)(u.Z.Label,{children:"Year:"}),(0,g.jsx)(u.Z.Select,{name:"year",value:P.year,onChange:E,onBlur:i,touched:a,isInvalid:!!l.year,children:f.map((function(e,t){return(0,g.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,g.jsx)(u.Z.Control.Feedback,{type:"invalid",children:l.year})]}),(0,g.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,g.jsx)(u.Z.Label,{children:"Subject:"}),(0,g.jsx)(u.Z.Select,{name:"subject",value:P.subject,onChange:M,onBlur:i,touched:a,isInvalid:!!l.subject,children:_.map((function(e,t){return(0,g.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,g.jsx)(u.Z.Control.Feedback,{type:"invalid",children:l.subject})]}),(0,g.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,g.jsx)(u.Z.Label,{children:"Module:"}),(0,g.jsx)(u.Z.Select,{name:"module",value:r.module,onChange:R,onBlur:i,touched:a,isInvalid:!!l.module,children:w.map((function(e,t){return(0,g.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,g.jsx)(u.Z.Control.Feedback,{type:"invalid",children:l.module})]}),(0,g.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,g.jsx)(u.Z.Label,{children:"Topic:"}),(0,g.jsx)(u.Z.Select,{name:"topic",value:P.topic,onChange:O,onBlur:i,touched:a,isInvalid:!!l.topic,children:q.map((function(e,t){return(0,g.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,g.jsx)(u.Z.Control.Feedback,{type:"invalid",children:l.topic})]}),(0,g.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,g.jsx)(u.Z.Label,{children:"Name:"}),(0,g.jsx)(u.Z.Control,{type:"text",placeholder:"Please enter a sub topic name.",name:"name",onChange:s,onBlur:i,value:r.name,touched:a,isInvalid:!!l.name}),(0,g.jsx)(u.Z.Control.Feedback,{type:"invalid",children:l.name})]}),(0,g.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,g.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Open",id:"permission-1",value:"0",checked:0===r.permission,onChange:T,onBlur:i}),(0,g.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Free",id:"permission-2",value:"1",checked:1===r.permission,onChange:T,onBlur:i}),(0,g.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Premium",id:"permission-3",value:"2",checked:2===r.permission,onChange:T,onBlur:i})]}),(0,g.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,g.jsx)(u.Z.Label,{children:"Description:"}),(0,g.jsx)(j.M,{tinymceScriptSrc:"/tinymce/tinymce.min.js",onInit:function(t,n){return e.current=n},init:{height:450,menubar:!0,plugins:["image","grid","tiny_mce_wiris","code","table","link","media","codesample"],toolbar:"undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | grid_insert | tiny_mce_wiris_formulaEditor tiny_mce_wiris_formulaEditorChemistry | help",draggable_modal:!0,content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"},name:"description"})]}),(0,g.jsxs)(c.Z,{type:"submit",variant:"primary",className:"float-end",children:[(0,g.jsx)("i",{className:"fa fa-save"})," Save"]})]})}})})]})}},85239:function(e,t,n){var s=n(61044),i=function(){return window.localStorage.getItem("token")?localStorage.getItem("token"):null},r=s.ZP.create({baseURL:"/api/v1/",timeout:15e3,headers:{Authorization:"Bearer ".concat(i())}});r.interceptors.request.use((function(e){return e.headers.Authorization="Bearer ".concat(i()),e})),r.interceptors.response.use((function(e){return e}),(function(e){return 401!==e.response.status&&403!==e.response.status&&406!==e.response.status||(window.localStorage.clear(),window.location.href="/login"),Promise.reject(e)})),t.Z=r}}]);
//# sourceMappingURL=3679.5d0fb131.chunk.js.map