"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[4053],{54053:function(e,t,n){n.r(t);var i=n(74165),a=n(1413),r=n(15861),s=n(70885),c=n(72791),o=n(9140),u=n(95313),l=n(43360),d=n(55705),p=n(81724),m=n(85239),h=n(9085),b=n(57689),f=n(85983),j=n(80184);t.default=function(){var e=(0,b.UO)(),t=(0,c.useRef)(null),n=(0,b.s0)(),Z=(0,c.useState)([]),g=(0,s.Z)(Z,2),v=g[0],x=g[1],y=(0,c.useState)([]),_=(0,s.Z)(y,2),C=_[0],k=_[1],w=(0,c.useState)([]),S=(0,s.Z)(w,2),B=S[0],q=S[1],I=(0,c.useState)({year:"",subject:"",topic:"",name:"",content:"",permission:0}),N=(0,s.Z)(I,2),E=N[0],L=N[1],P=p.Ry({year:p.Z_("Choose a year.").required("Year is required."),subject:p.Z_("Choose a subject.").required("Subject is required"),topic:p.Z_("Choose a topic.").required("Topic is required."),name:p.Z_("Enter a sub topic name.").test("len","Must be less than or equal to 64 characters.",(function(e){return e.length<=64})).required("Sub topic name is required.")});(0,c.useEffect)((function(){var e=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){var t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.Z.get("/admin/years/get-all-populate");case 2:t=e.sent,n=t.data,x(n),k(n.length?n[0].subjects:[]),q(n.length&&n[0].subjects.length?n[0].subjects[0].topics:[]),L((0,a.Z)((0,a.Z)({},E),{},{year:n.length?n[0]._id:"",subject:n.length&&n[0].subjects.length?n[0].subjects[0]._id:"",topic:n.length&&n[0].subjects.length&&n[0].subjects[0].topics.length?n[0].subjects[0].topics[0]._id:""}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,c.useEffect)((function(){var t=function(){var t=(0,r.Z)((0,i.Z)().mark((function t(){var n,r,s;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.id,t.next=3,m.Z.get("/admin/sub-topics/".concat(n));case 3:r=t.sent,(s=r.data).success?L((0,a.Z)((0,a.Z)({},E),{},{year:s.data.topic.subject.year._id,subject:s.data.topic.subject._id,topic:s.data.topic._id,name:s.data.name,content:s.data.content,permission:s.data.permission})):h.Am.error(s.msg);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[]);var A=function(e){var t=v.findIndex((function(t){return t._id===e.target.value}));k(v[t].subjects),q(v[t].subjects.length?v[t].subjects[0].topics:[]),L((0,a.Z)((0,a.Z)({},E),{},{year:e.target.value,subject:v[t].subjects.length?v[t].subjects[0]._id:"",topic:v[t].subjects.length&&v[t].subjects[0].topics.length?v[t].subjects[0].topics[0]._id:""}))},F=function(e){var t=C.findIndex((function(t){return t._id===e.target.value}));q(C[t].topics),L((0,a.Z)((0,a.Z)({},E),{},{subject:e.target.value,topic:C[t].topics.length?C[t].topics[0]._id:""}))},G=function(e){L((0,a.Z)((0,a.Z)({},E),{},{topic:e.target.value}))},z=function(e){L((0,a.Z)((0,a.Z)({},E),{},{permission:Number(e.target.value)}))},D=function(){var a=(0,r.Z)((0,i.Z)().mark((function a(r,s){var c,o,u,l;return(0,i.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return c=s.resetForm,o=e.id,r.content=t.current.getContent(),i.next=5,m.Z.put("admin/sub-topics/".concat(o),r);case 5:u=i.sent,(l=u.data).success?(h.Am.success(l.msg),c(),n("/admin/sub-topics")):h.Am.error(l.msg);case 8:case"end":return i.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}();return(0,j.jsxs)(o.Z,{children:[(0,j.jsx)(o.Z.Header,{style:{background:"#3c4b64"},bsPrefix:"card-header py-3",children:(0,j.jsx)(o.Z.Title,{bsPrefix:"card-title mb-0 text-light",as:"h5",children:"Edit subtopic"})}),(0,j.jsx)(o.Z.Body,{children:(0,j.jsx)(d.J9,{validationSchema:P,validateOnChange:!1,validateOnBlur:!1,onSubmit:D,initialValues:E,enableReinitialize:!0,children:function(e){var n=e.handleSubmit,i=e.handleChange,a=e.handleBlur,r=e.values,s=e.touched,c=e.errors;return(0,j.jsxs)(u.Z,{noValidate:!0,onSubmit:n,children:[(0,j.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,j.jsx)(u.Z.Label,{children:"Year:"}),(0,j.jsx)(u.Z.Select,{name:"year",value:E.year,onChange:A,onBlur:a,touched:s,isInvalid:!!c.year,children:v.map((function(e,t){return(0,j.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,j.jsx)(u.Z.Control.Feedback,{type:"invalid",children:c.year})]}),(0,j.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,j.jsx)(u.Z.Label,{children:"Subject:"}),(0,j.jsx)(u.Z.Select,{name:"subject",value:E.subject,onChange:F,onBlur:a,touched:s,isInvalid:!!c.subject,children:C.map((function(e,t){return(0,j.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,j.jsx)(u.Z.Control.Feedback,{type:"invalid",children:c.subject})]}),(0,j.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,j.jsx)(u.Z.Label,{children:"Topic:"}),(0,j.jsx)(u.Z.Select,{name:"topic",value:E.topic,onChange:G,onBlur:a,touched:s,isInvalid:!!c.topic,children:B.map((function(e,t){return(0,j.jsx)("option",{value:e._id,children:e.name},t)}))}),(0,j.jsx)(u.Z.Control.Feedback,{type:"invalid",children:c.topic})]}),(0,j.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,j.jsx)(u.Z.Label,{children:"Name:"}),(0,j.jsx)(u.Z.Control,{type:"text",placeholder:"Please enter a sub topic name.",name:"name",onChange:i,onBlur:a,value:r.name,touched:s,isInvalid:!!c.name}),(0,j.jsx)(u.Z.Control.Feedback,{type:"invalid",children:c.name})]}),(0,j.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,j.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Open",id:"permission-1",value:"0",checked:0===r.permission,onChange:z,onBlur:a}),(0,j.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Free",id:"permission-2",value:"1",checked:1===r.permission,onChange:z,onBlur:a}),(0,j.jsx)(u.Z.Check,{inline:!0,type:"radio",name:"permission",label:"Premium",id:"permission-3",value:"2",checked:2===r.permission,onChange:z,onBlur:a})]}),(0,j.jsxs)(u.Z.Group,{className:"mb-3",children:[(0,j.jsx)(u.Z.Label,{children:"Description:"}),(0,j.jsx)(f.M,{tinymceScriptSrc:"/tinymce/tinymce.min.js",onInit:function(e,n){return t.current=n},init:{height:450,menubar:!0,plugins:["image","grid","tiny_mce_wiris","code","table","link","media","codesample"],toolbar:"undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | grid_insert | tiny_mce_wiris_formulaEditor tiny_mce_wiris_formulaEditorChemistry | help",draggable_modal:!0,init_instance_callback:function(e){e.contentWindow.addEventListener("copy",(function(e){e.preventDefault()})),e.contentWindow.addEventListener("paste",(function(e){e.preventDefault()})),e.contentWindow.addEventListener("keydown",(function(e){!e.ctrlKey&&!e.metaKey||"p"!==e.key&&16!==e.charCode&&112!==e.charCode&&80!==e.keyCode||(e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))},content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"},name:"content",initialValue:r.content})]}),(0,j.jsxs)(l.Z,{type:"submit",variant:"primary",className:"float-end",children:[(0,j.jsx)("i",{className:"fa fa-save"})," Save"]})]})}})})]})}},85239:function(e,t,n){var i=n(61044),a=function(){return window.localStorage.getItem("token")?localStorage.getItem("token"):null},r=i.ZP.create({baseURL:"/api/v1/",timeout:15e3,headers:{Authorization:"Bearer ".concat(a())}});r.interceptors.request.use((function(e){return e.headers.Authorization="Bearer ".concat(a()),e})),r.interceptors.response.use((function(e){return e}),(function(e){return 401!==e.response.status&&403!==e.response.status&&406!==e.response.status||(window.localStorage.clear(),window.location.href="/login"),Promise.reject(e)})),t.Z=r}}]);
//# sourceMappingURL=4053.4ce12755.chunk.js.map